import{d as H,b as X,j as K,y as q,a as y,o as a,e as o,n as S,h,z as v,f as T,F as $,g as ee,i as d,t as m,A as te,c as E}from"./vue.esm-bundler-ngpQzEkL.js";import{_ as se,a as ne,b as ie,c as le,e as ae,d as oe,f as re}from"./word-URG0C6V6.js";import{u as x}from"./oss-B4DI-S0s.js";import{E as I}from"./index-D4rYSTCs.js";import{E as pe}from"./index-DTpu9bs_.js";import{i as ue}from"./httpV2-BKIcgRKj.js";const ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkNGOTMzN0Q1RkMyODExRTdCMkY4OUNGQjk2M0M1QjFBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkNGOTMzN0Q2RkMyODExRTdCMkY4OUNGQjk2M0M1QjFBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Q0Y5MzM3RDNGQzI4MTFFN0IyRjg5Q0ZCOTYzQzVCMUEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6Q0Y5MzM3RDRGQzI4MTFFN0IyRjg5Q0ZCOTYzQzVCMUEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7dQvP7AAAEIUlEQVR42mxU308UVxg9996ZnV0Wi/wQXaDaRGPTBjEtYIBS1IJKgVIVGkx9aExq0ncbU/kD6lOf+ti++IAB2iZNsDblh6QUqdKqdCtUiSZVaCiW7AosszM7M/f2u2s0FrqTm5nMfnPu+c4532VKKaz/qSA4zQJ5AlJWIEC+klIwTk+CJ8F5HEL00vMX679j/wFT6qDy/U9Zam0ffv2NP75xE4kHc/DSafCQicIXS1GwtwKorZXIi04q0+hmjI1uAFNSfcAymfPq95nYL/1fgc0vosh1kOv6EEpCgsMxgGTYwkqsCFXHOmHVVC8gJM4R2wvPwAKgUjhyAENDscnePgT0cYRebrVdRPwMuOKQzKdlYNU08E8kjETEQPWRI8hvb1lAOHISnI3yLK0g6ML0ndhUTx8KbQe1Zz7G3tYW2AaDIwwETFPXdw6fM1QdaMChM2cxfel74MdrMZA0GkaD1QpXfDR1sQcvOBmYktqe+QPsYAN2Nh/GUjQMV3BkTIHFHAvb99dDtr4NNnsXhY6L6W/6oZZX90EGpzVYkxu/u4nP/YWo7yEUSMQHBqAuXQZamlHe+BaSloVE2MTu+jqYHcfBh69gqu9rbHY9mMkVrI1PkNfyBEmKusWxn5HnusRKkogSxTZwf3gEuyQJd/Rd5D5OwnOJdccxYGgEswOXsS3jwaKNM4bA3K2beOVwY4UGK1+Zn8NWn/ySIOcAQ/pQpNONqxMoWl3FjlOnSBCGv3v7MTdxHSVegKjnP4kDyZJ4OA9kvHzdZsxJrWbtJ3nJuedSSIWO4xAwz8rrph36X4I/V6LrGYEjZQvNbMGK5pZpxzi0YwpeyEDK5KioqoTZ9R4eXeyDSxHZ/v5J7IhGcO/KGNUqhPwA2ZySQYjmBBrsdrSkuCz90CB2PjJc4BGJ/fIbdTA6O4GRYSyNj5OWxICcRfs72EU18dExbKHJkNT+pm0xwBJJzXgiVt+A5ZBFQDybpYrGQ7C02IODiH/3AwooAptdG7eJEbTLrW3Y09YGj+pdIVC6p5yENuMabDjy2qsZu6SUAmoSfQlVU0NbTOIehbLYTiMc+DQRipi4uD84DEVOs8rX4QnAi+Ygv+mAhCl6n87m+eWJ2U/ufP4ZiuwUXAqodlUzigYejZuuUXQJ2MQkGQ7DphpFvVdRdHC87RpMs/apMV/m1e3+9qWOrmzidX6yuaN7oDNCswklsrqFaPMcn6JDPcT2NwBtzQvgRvf6I6iaVndqJH50prcHuYklas+FoYKs/YqEllTrUEi9SATl7e2kXdOCCofOMSEubDzPgJ20PvQS6uzi1es8eesnrD34E77z5DzLK42hjMTOq39TYkvBJAzeDS5G//9wfJZVVccZa9SjRkN8CGlPMMsMYBpJEjquDBJbiA0n7b8CDACA8+BIWtGI0gAAAABJRU5ErkJggg==",b={error(s,r){return I({message:s,type:"warning",...r})},success(s,r){return I({message:s,type:"success",...r})},message(s,r){return I({message:s,...r})},warn(s,r){return I({message:s,type:"warning",...r})},loading:{},showLoading(s,r){this.loading=pe.service({lock:!0,text:s,background:"rgba(0, 0, 0, 0.7)",...r})},hideLoading(){this.loading&&this.loading.close()}},de={class:""},me={key:0,style:{display:"inline"},class:"el-upload__tip fc-gray6"},fe={key:0,class:"en-clo-li fl wid90 mar-top10"},ge={class:"clear"},ye=["onClick"],he=T("img",{src:ce},null,-1),be=[he],Te={key:1,class:"firstTag"},we=["onClick"],Ae={key:0,style:{width:"50px",height:"50px"},src:se},ve={key:1,style:{width:"50px",height:"50px"},src:ne},Ie={key:2,style:{width:"50px",height:"50px"},src:ie},Me={key:3,style:{width:"50px",height:"50px"},src:le},ke={key:4,style:{width:"50px",height:"50px"},src:ae},Ne={key:5,style:{width:"50px",height:"50px"},src:oe},Se={key:6,style:{width:"50px",height:"50px"},src:re},Ee={class:"textover ft-size12 fc-6"},xe={key:0,style:{height:"50px",width:"50px"}},M=H({__name:"main",props:{fileList:{type:Array,default(){return[]}},uploadPath:{type:String,default(){return"bussiness/"}},fileCount:{type:Number,default(){return 9}},showImg:{type:Boolean,default(){return!1}},fileKey:{type:String,default(){return""}},accept:{type:String,default(){return".jpg, .png,.jpeg,.doc,.xlsx,.ppt,.xls,.docx"}},changeParam:{type:Object,default(){return{}}},showTips:{type:Boolean,default(){return!0}},showImgFile:{type:Boolean,default(){return!0}},fileSize:{type:Number,default(){return 1024}},listType:{type:String,default(){return"picture"}}},emits:["change","uploadError"],setup(s,{emit:r}){const _=X(()=>x(window.pinia).upOss),p=s,t=K({fileList:[],updisabled:!1,form:{},myPercent:null}),k=r,F=e=>{};q(()=>{let e=[],i=["gif","jpg","jpeg","png"];console.log(JSON.stringify(p.fileList),"props.fileList"),p.fileList.forEach(u=>{let l=Object.assign({},u,{status:"success",type:"image"});if(l.url||(l.filePath.indexOf("http")>-1?l.url=l.filePath:l.url=F(u.filePath)),!l.fileType){let g=l.filePath.split("."),c=g[g.length-1];l.fileType=3,i.indexOf(c)>-1&&(l.fileType=1)}l.fileType!=1&&(l.type="file"),l.name||(l.name=l.fileName),e.push(l)}),console.log(JSON.stringify(e),"listlistlist"),t.files=e});const G=()=>{b.message("最多上传3张图片，请先删除在上传")},V=e=>{let i;return/jpg|png|jpeg/gi.test(e)?i=1:/mp3/gi.test(e)?i=2:/mp4|3gp|flv|xflv|mkv|wmv|avi|rmvb/gi.test(e)?i=4:i=3,i},Y=()=>{t.updisabled=!1,t.myPercent=0},B=(e,i)=>{t.fileList=i,k("change")},Z=(e,i)=>{t.updisabled=!1;let u=i.name.substring(i.name.lastIndexOf(".")+1);u=V(u),t.fileList.push({fileType:i.fileType||u,fileName:i.name,filePath:t.form.key,fileSize:i.size}),k("change",t.fileList)},D=()=>{b.message("上传失败,请重试"),k("uploadError"),ue.post("mml-syj/sys002").then(e=>{x(window.pinia).setOssConfig(e.data.result.oss)})},Q=async e=>L(e)!=!1,R=()=>{let e="";return e=p.uploadPath+""+"_"+Math.round(new Date().getTime()/1e3)+"_"+parseInt(Math.random()*9e3+1e3,10),e||"error"},J=e=>{t.myPercent=parseInt(e.percent)},L=e=>{if(e.size>p.fileSize*1024*1024)return b.message("最大只能上传"+p.fileSize+"M的文件"),!1;if(t.fileList.length>=p.fileCount)return b.message("最多只能上传"+p.fileCount+"个文件"),!1;if(p.fileType&&p.fileType!="*"){let N=p.fileType.replace(/,/g,"$|\\");if(!new RegExp(`\\${N}$`,"i").test(e.name))return b.message(`只能上传${p.fileType}类型的文件`),!1}let i=e.name.replace(/.+\./,""),u=R(),l=encodeURI(`${u+"."+i}`);t.form.key=l,t.form.success_action_status="200";let c=x(window.pinia).ossConfig;return t.form.policy=c.policy,t.form.OSSAccessKeyId=c.accessKeyId,t.form.signature=c.signature,t.updisabled=!0,!0};return(e,i)=>{const u=y("el-upload"),l=y("el-tag"),g=y("el-image"),c=y("el-tooltip"),N=y("el-progress");return a(),o("div",de,[S(u,{class:"upload-demo fl wid90 myWOssUpload",action:_.value,"before-upload":Q,disabled:t.updisabled,"on-success":Z,"on-error":D,"on-progress":J,"on-change":Y,"on-remove":B,"file-list":t.fileList,"list-type":s.listType,accept:t.accept,data:t.form,ref:"myUpload","on-exceed":G,limit:s.fileCount},{default:h(()=>[v(e.$slots,"default"),v(e.$slots,"tip",{},()=>[s.showImgFile&&s.showTips?(a(),o("div",me," 注："+m(e.fileTypeName)+"单个文件大小"+m(s.fileSize)+m(e.unitKB?"KB":"MB")+"以内；附件数量最多"+m(s.fileCount)+"个"+m(e.showTipsMore||""),1)):d("",!0)])]),_:3},8,["action","disabled","file-list","list-type","accept","data","limit"]),v(e.$slots,"imageList",{flieList:s.fileList,updisabled:t.updisabled,myPercent:t.myPercent}),s.showImgFile?(a(),o("div",fe,[T("ul",ge,[(a(!0),o($,null,ee(t.fileList,(n,A)=>(a(),o("li",{key:n.filePath+""+A},[e.showDelIcon?(a(),o("i",{key:0,class:"del pointer",onClick:W=>e.deleteFile(n)},be,8,ye)):d("",!0),e.showFirstTag&&A==0?(a(),o("i",Te,[S(l,{size:"small"},{default:h(()=>[te("首图")]),_:1})])):d("",!0),n.fileName?(a(),E(c,{key:2,placement:"bottom-start",disabled:e.isTips},{content:h(()=>[T("div",null,m(n.fileName),1)]),default:h(()=>[T("div",{style:{border:"1px solid #b5bfcf",height:"50px",width:"50px"},onClick:W=>e.show(n,A)},[e.playType.indexOf(n.myFileType)>=0&&!n.filePlaying?(a(),o("img",Ae)):e.playType.indexOf(n.myFileType)>=0&&n.filePlaying?(a(),o("img",ve)):n.myFileType=="xlsx"||n.myFileType=="xls"?(a(),o("img",Ie)):n.myFileType=="pdf"?(a(),o("img",Me)):n.myFileType=="ppt"||n.myFileType=="pptx"?(a(),o("img",ke)):n.myFileType=="txt"?(a(),o("img",Ne)):n.myFileType=="doc"||n.myFileType=="docx"?(a(),o("img",Se)):(a(),E(g,{key:7,style:{width:"50px",height:"50px"},src:n.thumbUrl,"preview-src-list":[n.url]},null,8,["src","preview-src-list"]))],8,we)]),_:2},1032,["disabled"])):d("",!0),n.fileName&&e.showFileName?(a(),E(c,{key:3,placement:"bottom-start"},{default:h(()=>[T("p",Ee,m(n.fileName),1)]),_:2},1024)):d("",!0),v(e.$slots,"bottomcontent",{data:n,index:A})]))),128)),t.updisabled?(a(),o("li",xe,[S(N,{width:50,type:"circle",percentage:t.myPercent},null,8,["percentage"])])):d("",!0)])])):d("",!0)])}}});M.__docgenInfo={exportName:"default",displayName:"main",description:"",tags:{},props:[{name:"fileList",description:"默认文件列表",type:{name:"Array<File>"},defaultValue:{func:!0,value:`function() {
  return [];
}`}},{name:"uploadPath",description:"默认上传路径",type:{name:"string"},defaultValue:{func:!0,value:`function() {
  return "bussiness/";
}`}},{name:"fileCount",description:"最大文件上传数量",type:{name:"number"},defaultValue:{func:!0,value:`function() {
  return 9;
}`}},{name:"showImg",description:"是否只显示文件",type:{name:"boolean"},defaultValue:{func:!0,value:`function() {
  return false;
}`}},{name:"fileKey",description:"指定文件上传key",type:{name:"string"},defaultValue:{func:!0,value:`function() {
  return "";
}`}},{name:"accept",description:"可上传的文件类型",type:{name:"string"},defaultValue:{func:!0,value:`function() {
  return ".jpg, .png,.jpeg,.doc,.xlsx,.ppt,.xls,.docx";
}`}},{name:"changeParam",description:"需要额外传递的参数",type:{name:"object"},defaultValue:{func:!1,value:"{}"}},{name:"showTips",description:"是否显示提示信息",type:{name:"boolean"},defaultValue:{func:!0,value:`function() {
  return true;
}`}},{name:"showImgFile",description:"是否显示已上传文件列表",type:{name:"boolean"},defaultValue:{func:!0,value:`function() {
  return true;
}`}},{name:"fileSize",description:"允许上传的文件大小",type:{name:"number"},defaultValue:{func:!0,value:`function() {
  return 1024;
}`}},{name:"listType",type:{name:"string"},defaultValue:{func:!0,value:`function() {
  return "picture"; //'text' | 'picture' | 'picture-card'
}`}}],events:[{name:"change"},{name:"uploadError"}],slots:[{name:"default"},{name:"tip"},{name:"imageList",scoped:!0,bindings:[{name:"flieList",title:"binding"},{name:"updisabled",title:"binding"},{name:"myPercent",title:"binding"}]},{name:"bottomcontent",scoped:!0,bindings:[{name:"data",title:"binding"},{name:"index",title:"binding"}]}],sourceFiles:["/home/runner/work/npm-vue3-plugins/npm-vue3-plugins/packages/components/upload/src/main.vue"]};const Ue={component:M,tags:["autodocs"],title:"COMPONENTS/Upload",argTypes:{},parameters:{componentSubtitle:"上传组件",docs:{description:{component:"上传组件描述"}}}},f={render:s=>({components:{Upload:M},setup(){return{args:s}},template:`
      <Upload ref="file" v-bind="args">
        <el-button size="small" type="primary">本地上传</el-button>
      </Upload>
      `}),args:{myFile:{importType:".png,.jpg",listType:"text",fileCount:1},showTips:!1,showFileName:!1}},w={render:s=>({components:{Upload:M},setup(){return{args:s}},template:`
      <Upload ref="file" v-bind="args">
        <el-button size="small" type="primary">本地上传</el-button>
      </Upload>
      `}),args:{...f.args,myFile:{importType:".png,.jpg",listType:"text",fileCount:1,fileList:[{filePath:"https://img2.baidu.com/it/u=257191799,4243921961&fm=253&fmt=auto&app=120&f=JPEG?w=500&h=854",fileName:"1.jpg"}]}}};var U,O,j;f.parameters={...f.parameters,docs:{...(U=f.parameters)==null?void 0:U.docs,source:{originalSource:`{
  render: args => ({
    components: {
      Upload
    },
    setup() {
      return {
        args
      };
    },
    template: \`
      <Upload ref="file" v-bind="args">
        <el-button size="small" type="primary">本地上传</el-button>
      </Upload>
      \`
  }),
  args: {
    myFile: {
      importType: ".png,.jpg",
      listType: "text",
      fileCount: 1
    },
    showTips: false,
    showFileName: false
  }
}`,...(j=(O=f.parameters)==null?void 0:O.docs)==null?void 0:j.source}}};var C,z,P;w.parameters={...w.parameters,docs:{...(C=w.parameters)==null?void 0:C.docs,source:{originalSource:`{
  render: args => ({
    components: {
      Upload
    },
    setup() {
      return {
        args
      };
    },
    template: \`
      <Upload ref="file" v-bind="args">
        <el-button size="small" type="primary">本地上传</el-button>
      </Upload>
      \`
  }),
  args: {
    ...Base.args,
    myFile: {
      importType: ".png,.jpg",
      listType: "text",
      fileCount: 1,
      fileList: [{
        filePath: "https://img2.baidu.com/it/u=257191799,4243921961&fm=253&fmt=auto&app=120&f=JPEG?w=500&h=854",
        fileName: "1.jpg"
      }]
    }
  }
}`,...(P=(z=w.parameters)==null?void 0:z.docs)==null?void 0:P.source}}};const Oe=["Base","Files"],Ge=Object.freeze(Object.defineProperty({__proto__:null,Base:f,Files:w,__namedExportsOrder:Oe,default:Ue},Symbol.toStringTag,{value:"Module"}));export{f as B,w as F,Ge as U};
